import numpy as np
import copy
import pprint


def calculate_limit_supermat(lista, condition):
    k = 1
    x = np.sum(lista)
    y = np.sum(lista, axis=1) / x
    # print(k)
    # print(y)
    listb = copy.deepcopy(lista)
    k += 1
    while True:
        listb = listb.dot(lista)
        # print(listb)
        x = np.sum(listb)
        n = np.sum(listb, axis=1) / x
        n= np.round(n,decimals=6)
        # print(x)
        # print(k)
        #print(n)
        delta = n - y
        # print("delta:", delta)
        temp = 0
        for i in delta:
            if i - condition > 0:
                temp = 1
                break
        if temp == 0:
            print("k is ",k)
            # for m in n:
            #     print(m)
            #pprint.pprint(n)
            # pprint.pprint(listb/)
            return n
            break
        else:
            k += 1
            y = n


A = np.array([[1, 6, 5, 1],
              [1 / 6, 1, 4, 2],
              [1 / 5, 1 / 4, 1, 8],
              [1, 1 / 2, 1 / 8, 1]],
             dtype=np.float64)
B = np.array([[1, 1 / 3, 4],
              [3, 1, 7],
              [1 / 4, 1 / 7, 1]])

C = np.array([[0, 0.2920, 0.0555, 0.0996, 0.1405, 0.0312, 0.1456, 0.1107, 0.0858, 0.0294, 0.0153, 0.0095, 0.0073],
              [0.0588, 0, 0.0882, 0.0577, 0.0349, 0.1967, 0.0230, 0.1314, 0.0195, 0.1331, 0.0033, 0.0059, 0.0218],
              [0.3902, 0.0751, 0, 0.5927, 0.0290, 0.0718, 0.1387, 0.0298, 0.1860, 0.0235, 0.0186, 0.0219, 0.0036],
              [0.3010, 0.3829, 0.6063, 0, 0.2956, 0.2003, 0.0260, 0.0613, 0.0420, 0.1472, 0.0028, 0.0027, 0.0073],
              [0.2143, 0.0278, 0.0417, 0.0250, 0, 0, 0.0259, 0.2269, 0.0648, 0.2269, 0.2667, 0.3429, 0.2667],
              [0.0357, 0.2222, 0.2083, 0.2250, 0, 0, 0.2333, 0.0324, 0.1944, 0.0324, 0.1333, 0.0571, 0.1333],
              [0, 0, 0, 0, 0.0878, 0.0195, 0, 0.0206, 0.0129, 0.0265, 0.0526, 0.1105, 0.0174],
              [0, 0, 0, 0, 0.0218, 0.1230, 0.0768, 0, 0.0307, 0.1323, 0.0152, 0.0231, 0.2195],
              [0, 0, 0, 0, 0.0181, 0.0449, 0.0922, 0.0823, 0, 0.0265, 0.0604, 0.1620, 0.0262],
              [0, 0, 0, 0, 0.1847, 0.1252, 0.0161, 0.0823, 0.1415, 0, 0.2317, 0.0643, 0.0969],
              [0, 0, 0, 0, 0.1162, 0.0655, 0.0236, 0.0443, 0.0132, 0.1697, 0, 0.0250, 0.1000],
              [0, 0, 0, 0, 0.0421, 0.0132, 0.1700, 0.0145, 0.1089, 0.0256, 0.1778, 0, 0.1000],
              [0, 0, 0, 0, 0.0293, 0.1088, 0.0286, 0.1634, 0.1002, 0.0269, 0.0222, 0.175, 0]], dtype=np.float64)

D = np.array([[0, 0, 5 / 6, 20 / 21],
              [0, 0, 1 / 6, 1 / 21],
              [2 / 3, 1 / 3, 0, 0],
              [1 / 3, 2 / 3, 0, 0]])
# a = calculate_limit_supermat(C, 0.0001)
# print(a[0]/(a[0]+a[1]+a[2]+a[3]))
# calculate_limit_supermat(D, 0.01)
